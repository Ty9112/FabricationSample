<UserControl x:Class="FabricationSample.UserControls.DatabaseEditor.DatabaseEditor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:utils="clr-namespace:FabricationSample.Utilities"
             mc:Ignorable="d"
             d:DesignHeight="460" d:DesignWidth="780" Loaded="UserControl_Loaded" Unloaded="UserControl_Unloaded"
             HorizontalAlignment="Stretch" VerticalAlignment="Stretch">

    <UserControl.Resources>
        <utils:SupplierIdsConverter x:Key="SupplierIdsConverter"/>
        <Style x:Key="GroupedHeaderStyle" TargetType="{x:Type GroupItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupItem}">
                        <StackPanel>
                            <TextBlock Text="{Binding Description}" />
                            <ItemsPresenter />
                        </StackPanel>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <TabControl x:Name="tbBody" TabStripPlacement="Left" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <TabControl.Resources>
            <Style TargetType="TabItem">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border Name="Border" BorderThickness="1,1,1,1" BorderBrush="Gainsboro"  Margin="1">
                                <ContentPresenter x:Name="ContentSite"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Left"
                                        ContentSource="Header"
                                        Margin="10,2"
                                        />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#FFF0F0F0" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="False">
                                    <Setter TargetName="Border" Property="Background" Value="White" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </TabControl.Resources>

        <TabItem x:Name="tbiJobItem" Header="Job Items" Height="24" VerticalAlignment="Top">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid x:Name="dgJobItems" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                  Loaded="dgJobItems_Loaded" CanUserSortColumns="True" ItemsSource="{Binding}" AutoGenerateColumns="False"
                  MouseDoubleClick="dgJobItems_MouseDoubleClick">
                    <DataGrid.ItemBindingGroup>
                        <BindingGroup/>
                    </DataGrid.ItemBindingGroup>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Binding="{Binding Name}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Source Description" Binding="{Binding SourceDescription}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Number" Binding="{Binding Number}" IsReadOnly="False"/>
                        <DataGridTextColumn Header="CID" Binding="{Binding CID}" IsReadOnly="False"></DataGridTextColumn>
                        <DataGridTextColumn Header="Pattern No" Binding="{Binding PatternNumber}" IsReadOnly="True"></DataGridTextColumn>
                        <DataGridCheckBoxColumn Header="Hidden" Binding="{Binding IsHiddenInViews}" IsReadOnly="False"/>
                        <DataGridTextColumn Header="Status" Binding="{Binding Status.Name}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Section" Binding="{Binding Section.Description}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Service" Binding="{Binding Service.Name}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Specification" Binding="{Binding Specification.Name}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="DatabaseId" Binding="{Binding DatabaseId}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Material" Binding="{Binding Material.Name}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Gauge" Binding="{Binding Gauge.Thickness}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="ID" Binding="{Binding UniqueId}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="ID Base64" Binding="{Binding UniqueIdBase64}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Weight" Binding="{Binding Weight}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Insulation Spec" Binding="{Binding InsulationSpecification}" IsReadOnly="True"/>

                    </DataGrid.Columns>
                </DataGrid>
                <DockPanel Grid.Row="1" VerticalAlignment="Top" Margin="0,5,0,0">
                    <TextBlock TextWrapping="Wrap" Width="180" Text="Change Item Status" VerticalAlignment="Center" Margin="5" />
                    <ComboBox x:Name="cmbItemStatus" Width="105" HorizontalAlignment="Left" Height="20" Text="Select Data Type" SelectionChanged="cmbItemStatus_SelectionChanged"/>
                </DockPanel>
                <DockPanel Grid.Row="2" VerticalAlignment="Top">
                    <TextBlock TextWrapping="Wrap" Width="180" Text="Change Item Section" VerticalAlignment="Center" Margin="5" />
                    <ComboBox x:Name="cmbItemSection" Width="105" HorizontalAlignment="Left" Height="20" Text="Select Data Type" SelectionChanged="cmbItemSection_SelectionChanged"/>
                </DockPanel>
                <DockPanel Grid.Row="3" VerticalAlignment="Top">
                    <TextBlock TextWrapping="Wrap" Width="180" Text="Change Item Service" VerticalAlignment="Center" Margin="5" />
                    <ComboBox x:Name="cmbService" Width="105" HorizontalAlignment="Left" Height="20" Text="Select Data Type" SelectionChanged="cmbService_SelectionChanged"/>
                </DockPanel>
                <StackPanel Grid.Row="4" Orientation="Horizontal" Margin="0,10,0,0">
                    <TextBlock TextWrapping="Wrap" Width="180" Text="Locate Item by ACAD Handle" VerticalAlignment="Center" Margin="5"  />
                    <TextBox x:Name="txtACADHandle" Height="25" Width="150" HorizontalAlignment="Left" BorderThickness="2" FontSize="12"/>
                    <Button x:Name="btnLocateItemByHandle" Width="100" Height="24" Content="Locate Item" Margin="200,0,0,0" Click="btnLocateItemByHandle_Click"/>
                </StackPanel>
                <StackPanel Grid.Row="5" Orientation="Horizontal" Margin="0,10,0,0">
                    <TextBlock TextWrapping="Wrap" Width="180" Text="Get AutoCAD Object Handle" VerticalAlignment="Center" Margin="5"  />
                    <TextBox x:Name="txtGetHandleFromFabItem" Height="25" Width="150" HorizontalAlignment="Left" BorderThickness="2" FontSize="12" IsReadOnly="True"/>
                    <Button x:Name="btnGetHandleFromFabItem" Width="100" Height="24" Content="Get Handle" Margin="200,0,0,0" Click="btnGetHandleFromFabItem_Click"/>
                </StackPanel>
                <StackPanel Grid.Row="6" Orientation="Horizontal" Margin="0,20,0,10">
                    <Button x:Name="btnSwapItem" Width="100" Height="25" Content="Swap Item" Margin="10,0,0,0" Click="btnSwapItem_Click" ToolTip="Swap selected item with another from the same service"/>
                    <Button x:Name="btnUndoSwap" Width="100" Height="25" Content="Undo Swap" Margin="10,0,0,0" Click="btnUndoSwap_Click" ToolTip="Undo the last item swap"/>
                    <Button x:Name="btnRemoveJobItem" Width="150" Height="25" Content="Remove Item From Job" Margin="30,0,0,0" Click="btnRemoveJobItem_Click"/>
                    <Button x:Name="btnSaveJob" Width="100" Height="25" Content="Save Job" Click="btnSaveJob_Click" Margin="10,0,0,0"/>
                    <Button x:Name="btnSaveJobAs" Width="100" Height="25" Content="Save Job As" Click="btnSaveJobAs_Click" Margin="10,0,0,0"/>
                    <Button x:Name="btnUpdateItems" Width="100" Height="25" HorizontalAlignment="Right" Content="Update Items" Click="btnUpdateItems_Click" Margin="10,0,0,0"/>
                </StackPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiMapProd" Header="Product Database">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid x:Name="dgMapprod" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" CanUserSortColumns="True" AutoGenerateColumns="False" MouseDoubleClick="dgMapprod_MouseDoubleClick" Loaded="dgMapprod_Loaded">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Group" Binding="{Binding Group.Name}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Install Type" Binding="{Binding InstallType}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Finish" Binding="{Binding Finish}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Specification" Binding="{Binding Specification}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Material" Binding="{Binding Material}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Product" Binding="{Binding ProductName}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Range" Binding="{Binding Range}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Size" Binding="{Binding Size}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Source" Binding="{Binding Source}" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Row="1">
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                        <TextBlock VerticalAlignment="Bottom" Margin="10,-1,0,0">Filter By Group</TextBlock>
                        <ComboBox Name="cmbMapProdFilterGroup" Width="150" Margin="10,0,0,0" SelectionChanged="cmbMapProdFilterGroup_SelectionChanged">
                        </ComboBox>
                        <TextBlock VerticalAlignment="Bottom" Margin="10,-1,0,0">Filter By Supplier</TextBlock>
                        <ComboBox Name="cmbMapProdFilterSupplier" Width="150" Margin="10,0,0,0" SelectionChanged="cmbMapProdFilterSupplier_SelectionChanged">
                        </ComboBox>
                        <TextBlock VerticalAlignment="Bottom" Margin="10,-1,0,0">Filter By Database Id</TextBlock>
                        <TextBox Name="txtFilterMapProdById" Width="150" Height="20" VerticalAlignment="Center" Margin="10,-1,0,0"></TextBox>
                        <Button Name="btnFilterProdGroup" Margin="10,0" Width="100" Click="btnFilterMapProdById_Click">Filter by Id</Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                        <TextBlock VerticalAlignment="Bottom" Margin="10,-1,0,0" Width="160">Create new Product Definition</TextBlock>
                        <TextBox Name="txtNewProductDefinition" Width="150" Height="20" VerticalAlignment="Center" Margin="10,-1,0,0"></TextBox>
                        <ComboBox Name="cmbNewProductDefinitionGroup" Width="150" Margin="10,0,0,0">
                        </ComboBox>
                        <Button Name="btnCreateProductDefinition" Margin="10,0" Width="148" Click="btnCreateProductDefinition_Click">Create Product Definition</Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                        <TextBlock VerticalAlignment="Bottom" Margin="10,-1,0,0" Width="160">Create new Product Group</TextBlock>
                        <TextBox Name="txtNewProductGroup" Width="150" Height="20" VerticalAlignment="Center" Margin="10,-1,0,0"></TextBox>
                        <Button Name="btnCreateProductGroup" Margin="10,0" Width="148" Click="btnCreateProductGroup_Click" >Create Product Group</Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                        <TextBlock VerticalAlignment="Bottom" Margin="10,-1,0,0" Width="160">Create new Product Supplier</TextBlock>
                        <TextBox Name="txtNewProductSupplier" Width="150" Height="20" VerticalAlignment="Center" Margin="10,-1,0,0"></TextBox>
                        <Button Name="btnCreateProductSupplier" Margin="10,0" Width="148" Click="btnCreateProductSupplier_Click" >Create Product Supplier</Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                        <Button Name="btnLoadMapProd" Margin="10,0" Click="btnLoadMapProd_Click" Width="150">Re-Load Product Entries</Button>
                        <Button Name="btnSave" Margin="10,0" Width="150" Click="btnSave_Click">Save Product Database</Button>
                        <Button Name="btnExportProductGrid" Margin="10,0" Width="120" Click="btnExportProductGrid_Click">Export Grid</Button>
                        <Button Name="btnGetProductInfo" Margin="10,0" Width="150" Click="btnGetProductInfo_Click">Export Full Product Info</Button>
                        <Button Name="btnImportProductDatabase" Margin="10,0" Width="160" Click="btnImportProductDatabase_Click">Import Product Database</Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,10">
                        <ProgressBar x:Name="prgProductDatabase" Height="20" Width="400" Margin="10,0" VerticalAlignment="Center" Minimum="0"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiPrices" Header="Price Lists" Loaded="tbiPrices_Loaded">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Border Grid.Row="0" Name="Border" BorderThickness="1,1,1,1" BorderBrush="DarkGray" Margin="1">
                    <ContentControl Name="ccPriceListTable" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                </Border>
                <DockPanel Grid.Row="1" VerticalAlignment="Top" Margin="0,10,0,0">
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Supplier Group" VerticalAlignment="Center" Margin="10,0" Width="110"/>
                    <ComboBox x:Name="cmbSupplierGroup" Width="130" HorizontalAlignment="Left" Margin="0,0,10,0" DisplayMemberPath="Name" SelectionChanged="cmbSupplierGroup_SelectionChanged" Height="25"
                    IsEditable="False" IsReadOnly="True"/>
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Price List" VerticalAlignment="Center" Margin="0,0,10,0" />
                    <ComboBox x:Name="cmbPriceList" Width="130" HorizontalAlignment="Left" Margin="0,0,10,0" Text="Select Data Type" SelectionChanged="cmbPriceList_SelectionChanged"/>
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Supplier ID" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,10,0"/>
                    <ComboBox x:Name="cmbSupplierId" Width="104" HorizontalAlignment="left" Margin="0" Text="Select Data Type" SelectionChanged="cmbSupplierId_SelectionChanged"/>
                </DockPanel>
                <DockPanel Grid.Row="2" VerticalAlignment="Top" Margin="0,10,0,0">
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Actions" VerticalAlignment="Center"
                     HorizontalAlignment="Left" Margin="10,0" Width="110" FontWeight="Bold"/>
                </DockPanel>
                <DockPanel Grid.Row="3" VerticalAlignment="Top" Margin="0,0,0,0" Height="25">
                    <Button Name="btnAddSupplierGroup" Width="120" Content="Add Supplier Group" Margin="10,0,0,0" Click="btnAddSupplierGroup_Click" HorizontalAlignment="Left"></Button>
                    <Button Name="btnDeleteSupplierGroup" Width="125" Margin="10,0,0,0" HorizontalAlignment="Left" Click="btnDeleteSupplierGroup_Click">Delete Supplier Group</Button>
                    <Button Name="btnEditSupplierGroup" Width="120" Margin="10,0,0,0" HorizontalAlignment="Left" Click="btnEditSupplierGroup_Click">Edit S. Group Name</Button>
                    <Button Name="btnAddProductEntry" Width="120" Margin="130,0,0,0" Click="btnAddProductEntry_Click" HorizontalAlignment="Left">Add Product Id Entry</Button>
                </DockPanel>
                <DockPanel Grid.Row="4" VerticalAlignment="Top" Margin="0,10,0,0" Height="25">
                    <Button Name="btnAddPriceList" Width="120" Margin="10,0,0,0" HorizontalAlignment="Left" Click="btnAddPriceList_Click">Add Price List</Button>
                    <Button Name="btnDeletePriceList" Width="125" Margin="10,0,0,0" HorizontalAlignment="Left" Click="btnDeletePriceList_Click">Delete Price List</Button>
                    <Button Name="btnEditPriceList" Width="120" Margin="10,0,0,0" HorizontalAlignment="Left" Click="btnEditPriceList_Click">Edit Price List Name</Button>
                    <Button Name="btnAddBreakPointRow" Width="80" Margin="80,0,0,0" Click="btnAddBreakPointRow_Click" HorizontalAlignment="Left">Add Row</Button>
                    <Button Name="btnAddBreakPointColumn" Width="80" Margin="10,0,0,0" Click="btnAddBreakPointColumn_Click" HorizontalAlignment="Left">Add Column</Button>
                </DockPanel>
                <DockPanel Grid.Row="5" VerticalAlignment="Top" Margin="10,10,0,10">
                    <ProgressBar x:Name="prgPriceList" Height="20" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Minimum="0"/>
                    <Button x:Name="btnUpdatePrices" Height="25" Width="100" Click="btnUpdatePrices_Click" Content="Update Prices" HorizontalAlignment="Right" Margin="10,0,10,0" DockPanel.Dock="Right"/>
                    <Button x:Name="btnImportPriceList" Height="25" Width="120" Click="btnImportPriceList_Click" Content="Import Price List" HorizontalAlignment="Right" Margin="0,0,0,0" DockPanel.Dock="Right"/>
                    <Button x:Name="btnExportPriceTables" Height="25" Width="120" Click="btnExportPriceTables_Click" Content="Export Price Tables" HorizontalAlignment="Right" Margin="0,0,0,0" DockPanel.Dock="Right"/>
                </DockPanel>
            </Grid>
        </TabItem>

        <TabItem Header="Supplier Discounts" Loaded="tbiSupplierDiscounts_Loaded">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid Grid.Row="0" Name="dgSupplierDiscounts" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" AutoGenerateColumns="False" SelectionMode="Single">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Code" Width="200" Binding="{Binding Code, Mode=TwoWay}" IsReadOnly="False"></DataGridTextColumn>
                        <DataGridTextColumn Header="Value" Width="200" Binding="{Binding Value, Mode=TwoWay}" IsReadOnly="False"></DataGridTextColumn>
                        <DataGridTextColumn Header="Description" Width="*" Binding="{Binding Description, Mode=TwoWay}" IsReadOnly="False"></DataGridTextColumn>
                    </DataGrid.Columns>
                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Delete Discount" Click="DeleteDiscount_Click"></MenuItem>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                </DataGrid>
                <DockPanel Grid.Row="1" VerticalAlignment="Center" Margin="0,10,0,0" >
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Supplier Group" Margin="10,0,0,0"/>
                    <ComboBox Name="cmbSupplierGroups" Width="250" HorizontalAlignment="Left" Margin="10,0,0,0"
                         SelectionChanged="cmbSupplierDiscounts_OnSelectionChanged" DisplayMemberPath="Name"
                         />
                </DockPanel>
                <DockPanel Grid.Row="2" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,10,0,10">
                    <Button Name="btnAddDiscount" Content="Add Discount" Width="100" Click="AddDiscount_Click" IsEnabled="False"></Button>
                    <Button Name="btnDeleteDiscount" Content="Delete Discount" Width="100" Margin="10,0,0,0" Click="DeleteDiscount_Click" IsEnabled="False"></Button>
                    <Button Name="btnExportSupplierDiscounts" Content="Export Discounts" Width="120" Margin="10,0,0,0" Click="btnExportSupplierDiscounts_Click"></Button>
                    <Button Name="btnImportSupplierDiscounts" Content="Import Discounts" Width="120" Margin="10,0,0,0" Click="btnImportSupplierDiscounts_Click"></Button>
                    <ProgressBar Name="prgSupplierDiscounts" Width="150" Height="20" Margin="10,0,0,0" Minimum="0" Maximum="100" Value="0"/>
                </DockPanel>
            </Grid>
        </TabItem>

        <TabItem x:Name="tbiFabTables" Header="Fabrication Tables" Loaded="tbiFabTimes_Loaded" Height="24" VerticalAlignment="Bottom">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <ContentControl Grid.Row="0" Name="ccFabricationTimes"
                            HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

                <DockPanel Grid.Row="1" VerticalAlignment="Top" Margin="0,10,0,0">
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Fabrication Table" VerticalAlignment="Center" Width="100" Margin="10,0,0,0" />
                    <ComboBox x:Name="cmbFabTimesTable" Width="200" HorizontalAlignment="Left" Text="Select Data Type" SelectionChanged="cmbFabTable_SelectionChanged">
                        <ComboBox.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Name="headerText" Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Name}" Value="">
                                                <Setter TargetName="headerText" Property="Text" Value="No Group"/>
                                            </DataTrigger>
                                        </DataTemplate.Triggers>

                                    </DataTemplate>
                                </GroupStyle.HeaderTemplate>
                            </GroupStyle>
                        </ComboBox.GroupStyle>
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}"></TextBlock>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Supplier ID" Width="70" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <ComboBox x:Name="cmbFabTableSupplierId" Width="200" HorizontalAlignment="Left" Text="Select Data Type" SelectionChanged="cmbFabTableSupplierId_SelectionChanged" Margin="0"/>
                </DockPanel>
                <DockPanel Grid.Row="2" VerticalAlignment="Top" Margin="0,5,0,0">
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Actions" VerticalAlignment="Center"
                     HorizontalAlignment="Left" Margin="10,0,0,0" Width="110" FontWeight="Bold"/>
                </DockPanel>
                <DockPanel Grid.Row="3" VerticalAlignment="Center" Margin="0,0,0,0">
                    <Button Height="25" Width="120" Content="Add Table" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewfabricationTable_Click"/>
                    <Button x:Name="btnDeleteFabTable" Height="25" Width="120" Content="Delete Table" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnDeleteFabTable_Click"/>
                    <Button x:Name="btnEditFabTable" Height="25" Width="120" Content="Edit Table Name" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnEditFabTable_Click"/>
                </DockPanel>
                <DockPanel Grid.Row="4" VerticalAlignment="Center" Margin="0,5,0,0">
                    <Button x:Name="btnNewFabTableProdEntry" Height="25" Width="120" Content="Add Product Id Entry" HorizontalAlignment="Left"
                            Margin="10,0,0,0" Click="btnNewFabTableProdEntry_Click"/>
                    <Button x:Name="btnNewFabTableRow" Height="25" Width="120" Content="Add Row" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewFabTableRow_Click"/>
                    <Button x:Name="btnNewFabTableColumn" Height="25" Width="120" Content="Add Column" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewFabTableColumn_Click"/>
                </DockPanel>
                <DockPanel Grid.Row="5" VerticalAlignment="Top" Margin="0,5,0,10">
                    <Button x:Name="btnUpdateFabricationTimes" Height="25" Width="150" Click="btnUpdateFabricationTimes_Click" Content="Update Fabrication Times" HorizontalAlignment="Right" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                    <ProgressBar x:Name="prgFabTimes" Height="20" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Minimum="0" Margin="10,0,0,0"/>
                </DockPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiInstallTables" Header="Installation Tables" Loaded="tbiInstallationTimes_Loaded" Height="24" VerticalAlignment="Bottom">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <ContentControl Grid.Row="0" Name="ccInstallTimes" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

                <DockPanel Grid.Row="1" VerticalAlignment="Top" Margin="0,10,0,0">
                    <TextBlock TextWrapping="Wrap" Text="Installation Table" VerticalAlignment="Center" Width="100" Margin="10,0,0,0" />
                    <ComboBox x:Name="cmbInstallationTimesTable" Width="150" SelectionChanged="cmbInstallationTable_SelectionChanged">
                        <ComboBox.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Name="headerText" Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Name}" Value="">
                                                <Setter TargetName="headerText" Property="Text" Value="No Group"/>
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </GroupStyle.HeaderTemplate>
                            </GroupStyle>
                        </ComboBox.GroupStyle>
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}"></TextBlock>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <TextBlock Text="Supplier ID" Width="70" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <ComboBox x:Name="cmbInstallTableSupplierId" Width="150" SelectionChanged="cmbInstallTableSupplierId_SelectionChanged" HorizontalAlignment="Left"/>
                    <TextBlock Text="Set" Width="30" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <ComboBox x:Name="cmbInstallTableSet" Width="50" SelectionChanged="cmbInstallTableSet_SelectionChanged" HorizontalAlignment="Left"/>
                </DockPanel>

                <DockPanel Grid.Row="2" VerticalAlignment="Top" Margin="0,5,0,0">
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Actions" VerticalAlignment="Center"
                     HorizontalAlignment="Left" Margin="10,0,0,0" Width="110" FontWeight="Bold"/>
                </DockPanel>
                <DockPanel Grid.Row="3" VerticalAlignment="Center" Margin="0,0,0,0">
                    <Button Height="25" Width="120" Content="Add Table" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewInstallTable_Click"/>
                    <Button x:Name="btnDeleteInstallTable" Height="25" Width="120" Content="Delete Table" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnDeleteInstallTable_Click"/>
                    <Button x:Name="btnEditInstallTable" Height="25" Width="120" Content="Edit Table Name" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnEditInstallTable_Click"/>
                </DockPanel>
                <DockPanel Grid.Row="4" VerticalAlignment="Center" Margin="0,5,0,0">
                    <Button x:Name="btnNewInstallTableProdEntry" Height="25" Width="120" Content="Add Product Id Entry" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewInstallationTableEntry_Click"/>
                    <Button x:Name="btnNewInstallTableRow" Height="25" Width="120" Content="Add Row" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewInstallTableRow_Click"/>
                    <Button x:Name="btnNewInstallTableColumn" Height="25" Width="120" Content="Add Column" HorizontalAlignment="Left" Margin="10,0,0,0" Click="btnNewInstallTableColumn_Click"/>
                </DockPanel>
                <DockPanel Grid.Row="5" VerticalAlignment="Top" Margin="0,5,0,10">
                    <ProgressBar x:Name="prgInstallationTimes" Height="20" Minimum="0" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Margin="10,0,0,0"/>
                    <Button x:Name="btnExportInstallationTimes" Width="170"
                            Click="btnExportInstallationTimes_Click" Content="Export Installation Times" Height="25" HorizontalAlignment="Right" Margin="0,0,10,0" DockPanel.Dock="Right"/>
                    <Button x:Name="btnImportInstallationTimes" Width="170"
                            Click="btnImportInstallationTimes_Click" Content="Import Installation Times" Height="25" HorizontalAlignment="Right" Margin="0,0,0,0" DockPanel.Dock="Right"/>
                    <Button x:Name="btnUpdateInstallationTimes" Width="150"
                            Click="btnUpdateInstallationTimes_Click" Content="Update Installation Times" Height="25" HorizontalAlignment="Right" Margin="0,0,0,0" DockPanel.Dock="Right"/>
                </DockPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiJobCustomData" Header="Job Custom Data">
            <Grid>
                <Grid.Resources>
                    <Style x:Key="DisableRow" TargetType="{x:Type DataGridRow}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Exists}" Value="True">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Resources>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid Grid.Row="0" x:Name="dgJobCustomData" VerticalAlignment="Stretch" CanUserSortColumns="True" AutoGenerateColumns="False" Loaded="dgJobCustomData_Loaded" >
                    <DataGrid.ItemBindingGroup>
                        <BindingGroup/>
                    </DataGrid.ItemBindingGroup>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id, Mode=TwoWay}" Width="50"/>
                        <DataGridTextColumn Header="Description" Width="200" Binding="{Binding Description, Mode=TwoWay}"/>
                        <DataGridComboBoxColumn Width="100" x:Name="cmbJobCustomDataType" Header="Data Type" TextBinding="{Binding DataType, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" SelectedItemBinding="{Binding DataType,Mode=TwoWay}" />
                        <DataGridTextColumn Header="Value" Width="180" Binding="{Binding Value, Mode=TwoWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="btnDeleteJobCustomData" Width="133" Height="24" HorizontalAlignment="Left" Content="Delete Custom Data" Click="btnDeleteJobCustomData_Click" Margin="0,0,0,0"/>
                    <Button x:Name="btnUpdateJobCustomData" Width="133" Height="24" HorizontalAlignment="Right" Content="Update Custom Data" Click="btnUpdateJobCustomData_Click" Margin="380,0,0,0"/>
                </StackPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiCustomData" Header="Item Custom Data">
            <Grid>
                <Grid.Resources>
                    <Style x:Key="DisableRow" TargetType="{x:Type DataGridRow}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Exists}" Value="True">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Resources>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid Grid.Row="0" x:Name="dgCustomData" VerticalAlignment="Stretch" CanUserSortColumns="True" AutoGenerateColumns="False" Loaded="dgCustomData_Loaded" >
                    <DataGrid.ItemBindingGroup>
                        <BindingGroup/>
                    </DataGrid.ItemBindingGroup>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id, Mode=TwoWay}" Width="50"/>
                        <DataGridTextColumn Header="Description" Width="200" Binding="{Binding Description, Mode=TwoWay}"/>
                        <DataGridComboBoxColumn Width="100" x:Name="cmbCustomDataType" Header="Data Type" TextBinding="{Binding DataType, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" SelectedItemBinding="{Binding DataType,Mode=TwoWay}" />
                        <DataGridComboBoxColumn Width="100" x:Name="cmbCustomDataAddMode" Header="Add Mode" TextBinding="{Binding AddMode, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" SelectedItemBinding="{Binding AddMode,Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Value" Width="180" Binding="{Binding Value, Mode=TwoWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="btnDeleteCustomData" Width="133" Height="24" HorizontalAlignment="Left" Content="Delete Custom Data" Click="btnDeleteCustomData_Click" Margin="0,0,0,0"/>
                    <Button x:Name="btnUpdateCustomData" Width="133" Height="24" HorizontalAlignment="Right" Content="Update Custom Data" Margin="380,0,0,0" Click="btnUpdateCustomData_Click"/>
                </StackPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiItemStatuses" Header="Item Statuses">
            <Grid>
                <Grid.Resources>
                    <Style x:Key="DisableRow" TargetType="{x:Type DataGridRow}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Exists}" Value="True">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                    <Style x:Key="DisableCell" TargetType="{x:Type DataGridCell}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Exists}" Value="True">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Resources>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid Grid.Row="0" x:Name="dgItemStatuses" VerticalAlignment="Stretch" CanUserSortColumns="True" AutoGenerateColumns="False" Loaded="dgItemStatuses_Loaded">
                    <DataGrid.ItemBindingGroup>
                        <BindingGroup/>
                    </DataGrid.ItemBindingGroup>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Binding="{Binding Id, Mode=TwoWay}" />
                        <DataGridTextColumn Header="Name" Width="120" Binding="{Binding Name, Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Layer Tag" Width="120" Binding="{Binding LayerTag, Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Color" Width="120" Binding="{Binding Color, Mode=TwoWay}"/>
                        <DataGridCheckBoxColumn Header="Output" Width="120" Binding="{Binding Output, Mode=TwoWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="btnDeleteItemStatuses" Width="133" Height="24" HorizontalAlignment="Left" Content="Delete Item Status" Margin="0,0,0,0" Click="btnDeleteItemStatuses_Click"/>
                    <Button x:Name="btnExportItemStatuses" Width="133" Height="24" HorizontalAlignment="Left" Content="Export Item Statuses" Margin="10,0,0,0" Click="btnExportItemStatuses_Click"/>
                    <Button x:Name="btnImportItemStatuses" Width="133" Height="24" HorizontalAlignment="Left" Content="Import Item Statuses" Margin="10,0,0,0" Click="btnImportItemStatuses_Click"/>
                    <Button x:Name="btnUpdateItemStatuses" Width="133" Height="24" HorizontalAlignment="Right" Content="Update Item Statuses" Margin="60,0,0,0" Click="btnUpdateItemStatuses_Click"/>
                </StackPanel>
            </Grid>
        </TabItem>
        <TabItem x:Name="tbiJobStatuses" Header="Job Statuses">
            <StackPanel>
                <StackPanel.Resources>
                    <Style x:Key="DisableRow" TargetType="{x:Type DataGridRow}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Exists}" Value="True">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                    <Style x:Key="DisableCell" TargetType="{x:Type DataGridCell}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Exists}" Value="True">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Resources>
                <DataGrid x:Name="dgJobStatuses" Height="410" VerticalAlignment="Top" CanUserSortColumns="True" AutoGenerateColumns="False" Loaded="dgJobStatuses_Loaded">
                    <DataGrid.ItemBindingGroup>
                        <BindingGroup/>
                    </DataGrid.ItemBindingGroup>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Description" Binding="{Binding Description, Mode=TwoWay}" />
                        <DataGridCheckBoxColumn Header="Active" Width="120" Binding="{Binding Active, Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Last Activated" Width="120" Binding="{Binding LastActivated, Mode=TwoWay}"/>
                        <DataGridCheckBoxColumn Header="DoSave" Width="120" Binding="{Binding DoSave, Mode=TwoWay}"/>
                        <DataGridComboBoxColumn Header="DoCopy" Width="120" x:Name="cmbJobStatusAction" TextBinding="{Binding DoCopy, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" SelectedItemBinding="{Binding DoCopy,Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Move/Copy To Folder" Width="120" Binding="{Binding CopyToFolder, Mode=TwoWay}"/>
                        <DataGridCheckBoxColumn Header="DoExport" Width="120" Binding="{Binding DoExport, Mode=TwoWay}"/>
                        <DataGridTextColumn Header="ExportFile" Width="120" Binding="{Binding ExportFile, Mode=TwoWay}"/>
                        <DataGridCheckBoxColumn Header="Deactivate On Completion" Width="150" Binding="{Binding DeActivateOnCompletion, Mode=TwoWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="btnDeleteJobStatuses" Width="133" Height="24" HorizontalAlignment="Left" Content="Delete Job Status" Margin="0,0,0,0" Click="btnDeleteJobStatuses_Click"/>
                    <Button x:Name="btnExportJobStatuses" Width="133" Height="24" HorizontalAlignment="Left" Content="Export Job Statuses" Margin="10,0,0,0" Click="btnExportJobStatuses_Click"/>
                    <Button x:Name="btnImportJobStatuses" Width="133" Height="24" HorizontalAlignment="Left" Content="Import Job Statuses" Margin="10,0,0,0" Click="btnImportJobStatuses_Click"/>
                    <Button x:Name="btnUpdateJobStatuses" Width="133" Height="24" HorizontalAlignment="Right" Content="Update Job Statuses" Margin="60,0,0,0" Click="btnUpdateJobStatuses_Click"/>
                </StackPanel>
            </StackPanel>
        </TabItem>

        <TabItem x:Name="tbiServiceTypes" Header="Service Types">
            <StackPanel>
                <StackPanel.Resources>
                    <Style x:Key="DisableRow" TargetType="{x:Type DataGridRow}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding CanModify}" Value="False">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Resources>
                <DataGrid x:Name="dgServiceTypes" Height="410" VerticalAlignment="Top" CanUserSortColumns="True" AutoGenerateColumns="False" RowStyle="{StaticResource DisableRow}" Loaded="dgServiceTypes_Loaded"  >
                    <DataGrid.ItemBindingGroup>
                        <BindingGroup/>
                    </DataGrid.ItemBindingGroup>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Id" Width="50" Binding="{Binding Id, Mode=TwoWay}"/>
                        <DataGridTextColumn Header="Name" Width="300" Binding="{Binding Name, Mode=TwoWay}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="btnDeleteServiceTypes" Width="133" Height="24" HorizontalAlignment="Right" Content="Delete Service Type" Margin="0,0,0,0" Click="btnDeleteServiceTypes_Click"/>
                    <Button x:Name="btnUpdateServiceTypes" Width="133" Height="24" HorizontalAlignment="Right" Content="Update Service Types" Margin="380,0,0,0" Click="btnUpdateServiceTypes_Click"/>
                </StackPanel>
            </StackPanel>
        </TabItem>
        <TabItem x:Name="tbiPointLocate" Header="Point Locate" Loaded="tbiPointLocate_Loaded" Height="24" VerticalAlignment="Top">
            <StackPanel>
                <DataGrid x:Name="dgPointLocate" Height="408" VerticalAlignment="Top" CanUserSortColumns="True" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Number" Width="100" Binding="{Binding Item.Number}"/>
                        <DataGridTextColumn Header="Name" Width="150" Binding="{Binding Item.Name}"/>
                        <DataGridTextColumn Header="Connection Type" Width="120" Binding="{Binding ConnType}"/>
                        <DataGridTextColumn Header="X" Width="100" Binding="{Binding Location.X}"/>
                        <DataGridTextColumn Header="Y" Width="100" Binding="{Binding Location.Y}"/>
                        <DataGridTextColumn Header="Z" Width="100" Binding="{Binding Location.Z}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <TextBlock Height="21" TextWrapping="Wrap" Text="Filter Points by Type" Margin="0,0,30,0"/>
                    <ComboBox x:Name="cmbFilterPoints" Width="180" HorizontalAlignment="Left"/>
                    <Button x:Name="btnPointLocate" Width="133" Height="24" HorizontalAlignment="left" Content="Locate Points" Click="btnPointLocate_Click" Margin="195,0,0,0"/>
                </StackPanel>
            </StackPanel>
        </TabItem>

        <TabItem x:Name="tbiServices" Header="Services" Loaded="tbiServices_Loaded" Height="24" VerticalAlignment="Top">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel Orientation="Vertical" Margin="5">

                    <!-- Service Selection -->
                    <DockPanel Margin="0,0,0,0">
                        <TextBlock Text="Select Service" Width="110" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <Button Content="Properties" Width="100" Click="serviceProperties_Click" DockPanel.Dock="Right" Margin="5,0,0,0"/>
                        <ComboBox Name="cmbSelectService" SelectionChanged="cmbSelectService_SelectionChanged">
                            <ComboBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ComboBox.GroupStyle>
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}"></TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </DockPanel>

                    <!-- Service Actions -->
                    <WrapPanel Margin="0,8,0,0" HorizontalAlignment="Stretch">
                        <Button Content="Edit Service Name" Width="115" Height="25" Margin="0,2,5,2" Click="EditServiceName_Click"/>
                        <Button Content="Add Service" Width="100" Height="25" Margin="0,2,5,2" Click="AddService_Click"/>
                        <Button Content="Delete Service" Width="100" Height="25" Margin="0,2,5,2" Click="DeleteService_Click"/>
                        <Button Content="Save Services" Width="100" Height="25" Margin="0,2,5,2" Click="SaveServices_Click"/>
                        <Button Content="Export Item Data" Width="115" Height="25" Margin="0,2,5,2" Click="btnExportItemData_Click"/>
                        <Button Content="Export Button Report" Width="140" Height="25" Margin="0,2,5,2" Click="btnExportButtonReport_Click"/>
                        <Button Content="Import Button Report" Width="140" Height="25" Margin="0,2,5,2" Click="btnImportButtonReport_Click"/>
                    </WrapPanel>

                    <!-- Service Template -->
                    <DockPanel Margin="0,15,0,0">
                        <TextBlock Text="Service Template" Width="110" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox Name="cmbUseServiceTemplate" SelectionChanged="cmbUseServiceTemplate_SelectionChanged">
                            <ComboBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ComboBox.GroupStyle>
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}"></TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </DockPanel>

                    <!-- Service Specification -->
                    <DockPanel Margin="0,8,0,0">
                        <TextBlock Text="Specification" Width="110" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <CheckBox Name="chkServiceSpecification" VerticalAlignment="Center" Click="chkServiceSpecification_Click" DockPanel.Dock="Right" Margin="5,0,0,0"/>
                        <TextBlock Text="Not Set" VerticalAlignment="Center" DockPanel.Dock="Right" Margin="5,0,0,0"/>
                        <ComboBox Name="cmbServiceSpecification" SelectionChanged="cmbServiceSpecification_SelectionChanged">
                            <ComboBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ComboBox.GroupStyle>
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}"></TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </DockPanel>

                    <!-- Service Buttons Tab Control -->
                    <ContentControl Name="ButtonsTabControl_Services" Margin="0,15,0,0"
                            HorizontalAlignment="Stretch"/>

                    <!-- Button Item Details -->
                    <DockPanel Margin="0,15,0,0">
                        <TextBlock Text="Select Button Item" Width="110" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox Name="cmbSelectButtonItem" SelectionChanged="cmbSelectButtonItem_SelectionChanged">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ServiceTemplateCondition.Description}"></TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </DockPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                        <Label Content="Greater Than:"/>
                        <Label Content="Value" x:Name="labGreaterThan"/>
                        <Label Content="Less Than Or Equal To:" Margin="30,0,0,0"/>
                        <Label Content="Value" x:Name="labLessThan"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Item Path:" />
                        <Label x:Name="labItemPath" Content="Path" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,15,0,10">
                        <Button x:Name="btnAddItem" Content="Add Item To Job" Height="25" Width="120" Click="btnAddItem_Click"/>
                    </StackPanel>

                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiServiceTemplates" Header="Service Templates" Loaded="tbiServiceTemplates_Loaded" Unloaded="tbiServiceTemplates_UnLoaded">
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Margin="0,10,0,0">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" MinHeight="420">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Select Service Template" Width="150"></Label>
                        <ComboBox Name="cmbSelectServiceTemplate" Width="460" SelectionChanged="cmbSelectServiceTemplate_SelectionChanged" DisplayMemberPath="Name"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button Content="Edit Template Name" Click="editServiceTemplateName_Click" Width="130" />
                        <Button Content="Add Template" Click="addServiceTemplate_Click" Margin="10,0,0,0" Width="115" />
                        <Button Content="Delete Template" Click="deleteServiceTemplate_Click" Margin="10,0,0,0" Width="115" />
                    </StackPanel>
                    <StackPanel>
                        <ContentControl Name="ButtonsTabControl_Templates" Margin="0,20,0,0"
                            HorizontalAlignment="Stretch"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <Label Content="Actions" FontWeight="Bold" HorizontalAlignment="Center" />
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                        <Button Content="Add New Template Condition" Width="190" Click="addServiceTemplateCondition_Click" />
                        <Button Content="Add New Tab" Width="105" Click="addServiceTab_Click"  Margin="10,0,0,0" />
                        <Button Content="Add Button" Width="100" Click="addServiceButton_Click"  Margin="10,0,0,0"/>
                        <Button Content="Save" Width="90" Click="btnSaveServiceTemplates_Click" Margin="10,0,0,0"></Button>
                        <Button Content="Export Button Report" Width="155" Click="btnExportTemplateButtonReport_Click" Margin="10,0,0,0"/>
                        <Button Content="Import Button Report" Width="155" Click="btnImportTemplateButtonReport_Click" Margin="10,0,0,0"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <Label Content="Service Template Conditions" FontWeight="Bold" HorizontalAlignment="Center" />
                    </StackPanel>

                    <DataGrid x:Name="dgTemplateConditions" VerticalAlignment="Top" CanUserSortColumns="True" Margin="5,10,0,0"
                    AutoGenerateColumns="False" Loaded="dgTemplateConditions_OnLoaded" ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                        VerticalScrollBarVisibility="Hidden" CanUserAddRows="True" CanUserDeleteRows="True" 
                        SelectionMode="Single" Width="600" HorizontalAlignment="Left" RowEditEnding="dgTemplateConditions_rowEditEnding">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Description" Width="300" Binding="{Binding Description, Mode=TwoWay}"/>
                            <DataGridTextColumn Header="Greater Than" Width="150" Binding="{Binding GreaterThan, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"/>
                            <DataGridTextColumn Header="Less Than or Equal To" Width="150" Binding="{Binding LessThanOrEqual, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"/>
                        </DataGrid.Columns>

                        <DataGrid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Delete Condition" Click="deleteTemplateCondition_Click"></MenuItem>
                            </ContextMenu>
                        </DataGrid.ContextMenu>

                        <!--<DataGrid.ItemContainerStyle>
              <Style TargetType="{x:Type MenuItem}"></Style>
            </DataGrid.ItemContainerStyle>-->

                    </DataGrid>
                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiMaterials" Header="Materials" Loaded="tbiMaterials_Loaded">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                <StackPanel Orientation="Vertical" Width="610" MinHeight="420">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Select Material" Width="150"></Label>
                        <ComboBox Name="cmbSelectMaterial" Width="460" SelectionChanged="cmbSelectMaterial_SelectionChanged">
                            <ComboBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Name="groupText" Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                            <DataTemplate.Triggers>
                                                <DataTrigger Binding="{Binding Name}" Value="">
                                                    <Setter TargetName="groupText" Property="Text" Value="No Group"/>
                                                </DataTrigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ComboBox.GroupStyle>
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}"></TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Edit Material" Click="editMaterial_Click" Margin="0,0,5,0" Width="115" />
                        <Button Content="Add Material" Click="addMaterial_Click" Margin="0,0,5,0" Width="115" />
                        <Button Content="Delete Material" Click="deleteMaterial_Click" Margin="0,0,0,0" Width="115" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                        <Label Content="Gauges" FontWeight="Bold"></Label>
                    </StackPanel>
                    <StackPanel Margin="0,5,0,0">
                        <ContentControl Name="GaugesView" Width="610" 
                            HorizontalAlignment="Left"/>
                    </StackPanel>

                    <Label Content="Actions" FontWeight="Bold" Margin="0,20,0,0"></Label>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Name="btnAddGauge" Content="Add Gauge" Width="115" Click="btnAddGauge_Click"></Button>
                        <Button Name="btnAddGaugeSize" Content="Add Gauge Size" Width="115" Click="btnAddGaugeSize_Click" Margin="5,0,0,0"></Button>
                        <Button Name="btnSaveMaterials" Content="Save Materials" Width="115" Click="btnSaveMaterials_Click" Margin="260,0,0,0"></Button>

                    </StackPanel>

                    <Label Content="Gauge Sizes" FontWeight="Bold" Margin="0,10,0,0"></Label>
                    <StackPanel Margin="0,5,0,20">
                        <ContentControl Name="GaugesSizesView" Width="610" 
                            HorizontalAlignment="Left"/>
                    </StackPanel>

                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiSections" Header="Sections" Loaded="tbiSections_Loaded">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                <StackPanel Orientation="Vertical" Width="610" MinHeight="420">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Select Section" Width="150"></Label>
                        <ComboBox Name="cmbSelectSection" Width="460" SelectionChanged="cmbSelectSection_SelectionChanged">
                            <ComboBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Name="groupText" Text="{Binding Name}" FontWeight="Bold"></TextBlock>
                                            <DataTemplate.Triggers>
                                                <DataTrigger Binding="{Binding Name}" Value="">
                                                    <Setter TargetName="groupText" Property="Text" Value="No Group"/>
                                                </DataTrigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>

                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ComboBox.GroupStyle>
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Description}"></TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Edit Section" Click="editSection_Click" Margin="0,0,5,0" Width="115" />
                        <Button Content="Add Section" Click="addSection_Click" Margin="0,0,5,0" Width="115" />
                        <Button Content="Delete Section" Click="deleteSection_Click" Margin="0,0,0,0" Width="115" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                        <Label Content="Index" Width="93" HorizontalContentAlignment="Right"></Label>
                        <TextBox Name="txtSectionIndex"  Margin="10,0,0,0" Width="50" PreviewTextInput="txtSectionIndex_PreviewTextInput" LostFocus="txtSectionIndex_LostFocus"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Difficulty Factor" Width="93" HorizontalContentAlignment="Right"></Label>
                        <TextBox Name="txtSectionDiffFactor" Margin="10,0,0,0" Width="50" PreviewTextInput="txtSectionDiffFactor_PreviewTextInput" LostFocus="txtSectionDiffFactor_LostFocus"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Retro Fitted" Width="93" HorizontalContentAlignment="Right"></Label>
                        <CheckBox Name="chkSectionRetroFitted" Margin="10,0,0,0" VerticalAlignment="Center" Checked="chkSectionRetroFitted_Checked" Unchecked="chkSectionRetroFitted_Unchecked"></CheckBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Retro Fitted %" Width="93" HorizontalContentAlignment="Right"></Label>
                        <TextBox Name="txtSectionRetroPercent" Margin="10,0,0,0" Width="50" PreviewTextInput="txtSectionRetroPercent_PreviewTextInput" LostFocus="txtSectionRetroPercent_LostFocus"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Layer Tag" Width="93" HorizontalContentAlignment="Right"></Label>
                        <TextBox Name="txtSectionLayerTag" Margin="10,0,0,0" Width="200" LostFocus="txtSectionLayerTag_LostFocus"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Floor Level" Width="93" HorizontalContentAlignment="Right"></Label>
                        <TextBox Name="txtSectionFloorLevel" Margin="10,0,0,0" Width="50" PreviewTextInput="txtSectionFloorLevel_PreviewTextInput" LostFocus="txtSectionFloorLevel_LostFocus"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Label Content="Slab Level" Width="93" HorizontalContentAlignment="Right"></Label>
                        <TextBox Name="txtSectionSlabLevel" Margin="10,0,0,0" Width="50" PreviewTextInput="txtSectionSlabLevel_PreviewTextInput" LostFocus="txtSectionSlabLevel_LostFocus"></TextBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="8,5,0,0" Height="25">
                        <Button Content="Color Picker" Width="80" Click="btnSectionColorPicker_Click"></Button>
                        <Border Width="25" Margin="15,0,0,0" BorderThickness="1,1,1,1" BorderBrush="Black">
                            <Rectangle Name="rectSectionColor" Width="25"></Rectangle>
                        </Border>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0" HorizontalAlignment="Right" Height="25">
                        <Button Name="btnExportSections" Content="Export Sections" Click="btnExportSections_Click" Width="100" Margin="0,0,5,0"></Button>
                        <Button Name="btnImportSections" Content="Import Sections" Click="btnImportSections_Click" Width="100" Margin="0,0,5,0"></Button>
                        <Button Name="btnSaveSections" Content="Save Sections" Click="btnSaveSections_Click" Width="100"></Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0" Height="25">
                        <ProgressBar x:Name="prgSections" Height="20" Width="400" Margin="0,0" VerticalAlignment="Center" Minimum="0"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiAncillaries" Header="Ancillaries" Loaded="tbiAncillaries_Loaded">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                <StackPanel Orientation="Vertical" Width="610" MinHeight="420">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Label Content="Select Ancillary Type" Width="150"></Label>
                        <ComboBox Name="cmbSelectAncillary" Width="460" SelectionChanged="cmbSelectAncillary_SelectionChanged">
                            <!--<ComboBoxItem Content="Airturn Tracks" />
              <ComboBoxItem Content="Airturn Vanes" />
              <ComboBoxItem Content="Ancillary Materials" />
              <ComboBoxItem Content="Clips" />
              <ComboBoxItem Content="Corners" />
              <ComboBoxItem Content="Fixings" />
              <ComboBoxItem Content="Gasket" />
              <ComboBoxItem Content="Isolators" />
              <ComboBoxItem Content="Sealant" />
              <ComboBoxItem Content="Seam Material" />
              <ComboBoxItem Content="Support Rods" />
              <ComboBoxItem Content="Tie Rods" />-->
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Edit Ancillary" Click="editAncillary_Click" Margin="0,0,5,0" Width="115" />
                        <Button Content="Add Ancillary" Click="addAncillary_Click" Margin="0,0,5,0" Width="115" />
                        <Button Content="Delete Ancillary" Click="deleteAncillary_Click" Margin="0,0,0,0" Width="115" />
                    </StackPanel>

                    <StackPanel Margin="0,10,0,0" Height="330">
                        <ContentControl x:Name="ccAncillaries" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0" HorizontalAlignment="Right" Height="25">
                        <Button Content="Save Ancillaries" Click="saveAncillaries_Click"></Button>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiJobInformation" Header="Job Information" Loaded="tbiJobInformation_Loaded">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                <StackPanel Orientation="Vertical" Margin="0,5">
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Job Name" VerticalAlignment="Center"  />
                        <TextBox x:Name="txtJobName" Height="25" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12" IsReadOnly="True"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Job Reference" VerticalAlignment="Center"  />
                        <TextBox x:Name="txtReference" Height="25" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Job Field1" VerticalAlignment="Center"  />
                        <TextBox x:Name="txtJobField1" Height="25" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Job Field2" VerticalAlignment="Center"  />
                        <TextBox x:Name="txtJobField2" Height="25" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Job Creation Date" VerticalAlignment="Center"/>
                        <TextBox x:Name="txtJobDate" Height="25" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12" IsReadOnly="True"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Customer" VerticalAlignment="Center"  />
                        <TextBox x:Name="txtJobCustomer" Height="25" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12" IsReadOnly="True"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Customer Address" VerticalAlignment="Top"  />
                        <TextBox x:Name="txtJobCustomerAddress" Height="60" Width="271" HorizontalAlignment="Left" BorderThickness="2" FontSize="12" IsReadOnly="True" TextWrapping="WrapWithOverflow"/>
                    </DockPanel>
                    <DockPanel  DockPanel.Dock="Top"  VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Required Date" VerticalAlignment="Center"  />
                        <DatePicker x:Name="dtpRequiredDate" Width="271" Margin="0,0,10,0" FirstDayOfWeek="Monday" IsTodayHighlighted="True" HorizontalAlignment="Left"/>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top" VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Custom Job Data" VerticalAlignment="Center"  />
                        <DataGrid x:Name="dgJobInfoCustomData" CanUserAddRows="False" VerticalAlignment="Top" Loaded="dgJobInfoCustomData_Loaded" CanUserSortColumns="False" ItemsSource="{Binding}" AutoGenerateColumns="False">
                            <DataGrid.ItemBindingGroup>
                                <BindingGroup/>
                            </DataGrid.ItemBindingGroup>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Description" Binding="{Binding Description}" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Value" Binding="{Binding Value, Mode=TwoWay}"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </DockPanel>
                    <DockPanel DockPanel.Dock="Top" VerticalAlignment="Top" Margin="5">
                        <TextBlock TextWrapping="Wrap" Width="180" Text="Job Statuses" VerticalAlignment="Center"  />
                        <DataGrid x:Name="dgJobInfoStatuses" CanUserAddRows="False" VerticalAlignment="Top" Loaded="dgJobInfoStatuses_Loaded" CanUserSortColumns="False" ItemsSource="{Binding}" AutoGenerateColumns="False">
                            <DataGrid.ItemBindingGroup>
                                <BindingGroup/>
                            </DataGrid.ItemBindingGroup>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Description" Binding="{Binding Description}"  IsReadOnly="True"/>
                                <DataGridCheckBoxColumn Header="Active" Width="120" Binding="{Binding Active}" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Last Activated" Width="140" Binding="{Binding LastActivated}" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </DockPanel>

          <DockPanel DockPanel.Dock="Top" VerticalAlignment="Top" Margin="5">
            <TextBlock TextWrapping="Wrap" Width="120" Text="Print Object" VerticalAlignment="Bottom" Margin="5"></TextBlock>
            <ComboBox x:Name="cmbJobPO" Width="200" HorizontalAlignment="Left" Height="24" VerticalContentAlignment="Center" SelectionChanged="CmbJobPO_OnSelectionChanged" Loaded="CmbJobPO_OnLoaded" ></ComboBox>
            <TextBlock x:Name="txtJobPO" Text="" Width="120" VerticalAlignment="Center"></TextBlock>
          </DockPanel>

          <DockPanel  DockPanel.Dock="Bottom"  VerticalAlignment="Top" Margin="0,80,0,0">
                        <Button x:Name="btnUpdateJobInfo" Width="140" Height="24" DockPanel.Dock="Right" HorizontalAlignment="Right" Content="Update Job Information"  Margin="0,0,10,0" Click="btnUpdateJobInfo_Click"/>
                    </DockPanel>
                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiCreateItem" Header="Manage Content" Loaded="tbiCreateItem_Loaded">
            <StackPanel Orientation="Vertical">
                <StackPanel.Resources>
                    <Style TargetType="{x:Type TreeViewItem}">
                        <!-- Style for the selected item -->
                        <Setter Property="BorderThickness" Value="1"/>
                        <Style.Triggers>
                            <!-- Selected and has focus -->
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="BorderBrush" Value="#7DA2CE"/>
                            </Trigger>

                            <!-- Selected but does not have the focus -->
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="True"/>
                                    <Condition Property="IsSelectionActive" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="BorderBrush" Value="#D9D9D9"/>
                            </MultiTrigger>
                        </Style.Triggers>
                        <Style.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="2"/>
                            </Style>
                        </Style.Resources>
                    </Style>
                </StackPanel.Resources>

                <StackPanel>
                    <ContentControl Name="ItemsFolder_ManageContent" Width="620"
                            HorizontalAlignment="Left"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                    <Button x:Name="btnExportContent" Width="120" Height="24"
                            Content="Export Items" Click="btnExportContent_Click" Margin="0,0,10,0"/>
                    <Button x:Name="btnImportContent" Width="120" Height="24"
                            Content="Import Items" Click="btnImportContent_Click"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Height="60" >
                    <ContentControl Name="ccItemCreateContent"></ContentControl>
                </StackPanel>

            </StackPanel>
        </TabItem>
        <TabItem x:Name="tbiSpecifications" Header="Specifications" Loaded="tbiSpecifications_Loaded">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <DataGrid Grid.Row="0" x:Name="dgSpecifications" VerticalAlignment="Stretch" CanUserSortColumns="True" AutoGenerateColumns="False" IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Width="250" Binding="{Binding Name}"/>
                        <DataGridTextColumn Header="Group" Width="*" Binding="{Binding Group}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,10">
                    <Button x:Name="btnExportSpecifications" Width="140" Height="24" Content="Export Specifications" Click="btnExportSpecifications_Click"/>
                    <Button x:Name="btnImportSpecifications" Width="140" Height="24" Content="Import Specifications" Margin="10,0,0,0" Click="btnImportSpecifications_Click"/>
                    <ProgressBar x:Name="prgSpecifications" Height="20" Width="200" Margin="10,0,0,0" Minimum="0" Maximum="100" Value="0"/>
                    <Button x:Name="btnSaveSpecifications" Width="140" Height="24" Content="Save Specifications" Margin="10,0,0,0" Click="btnSaveSpecifications_Click"/>
                </StackPanel>
            </Grid>
        </TabItem>

        <TabItem x:Name="tbiApplication" Header="Application" Height="24" VerticalAlignment="Top" Loaded="tbiApplication_Loaded">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" CanContentScroll="True">
                <StackPanel Orientation="Vertical" Width="631" Height="450">
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Configuration Name" Width="200"></TextBlock>
                        <TextBlock Name="txtAppConfigName" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Executable Name" Width="200"></TextBlock>
                        <TextBlock Name="txtAppExeName" Text="" ></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Executable Path" Width="200"></TextBlock>
                        <TextBlock Name="txtAppExePath" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Working Directory" Width="200"></TextBlock>
                        <TextBlock Name="txtAppWorkingDirectory" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Version Name" Width="200"></TextBlock>
                        <TextBlock Name="txtAppVersionName" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Version Number" Width="200"></TextBlock>
                        <TextBlock Name="txtAppVersionNumber" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Product Version" Width="200"></TextBlock>
                        <TextBlock Name="txtAppProductVersion" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Profile Name" Width="200"></TextBlock>
                        <TextBlock Name="txtAppProfileName" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Item Path (Current Profile)" Width="200"></TextBlock>
                        <TextBlock Name="txtAppItemPath" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Database Path (Current Profile)" Width="200"></TextBlock>
                        <TextBlock Name="txtAppDatabase" Text=""></TextBlock>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,10,0,0">
                        <TextBlock Text="Database Units" Width="200"></TextBlock>
                        <TextBlock Name="txtAppDatabaseUnits" Text=""></TextBlock>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem x:Name="tbiProfiles" Header="Profiles" Loaded="tbiProfiles_Loaded" Height="24" VerticalAlignment="Top">
            <Grid Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*" MinHeight="100"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Current Profile Info -->
                <StackPanel Grid.Row="0" Margin="0,0,0,8">
                    <TextBlock x:Name="txtProfileCurrentInfo" FontWeight="SemiBold" FontSize="13"/>
                    <TextBlock x:Name="txtProfileCurrentPath" FontSize="11" Foreground="#666666" TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Source Profile Selection -->
                <GroupBox Grid.Row="1" Header="Copy From Profile" Margin="0,0,0,8" Padding="6">
                    <StackPanel>
                        <DockPanel>
                            <TextBlock Text="Source:" Width="55" VerticalAlignment="Center"/>
                            <ComboBox x:Name="cmbProfileSource" Height="26"
                                      SelectionChanged="cmbProfileSource_SelectionChanged"
                                      DisplayMemberPath="" IsEditable="False">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                                <ComboBox.ItemContainerStyle>
                                    <Style TargetType="ComboBoxItem">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsCurrent}" Value="True">
                                                <Setter Property="Foreground" Value="#999999"/>
                                                <Setter Property="FontStyle" Value="Italic"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                            </ComboBox>
                        </DockPanel>
                        <TextBlock x:Name="txtProfileSourcePath" FontSize="11" Foreground="#888888" TextWrapping="Wrap" Margin="55,4,0,0"/>
                    </StackPanel>
                </GroupBox>

                <!-- Options Row -->
                <StackPanel Grid.Row="2" Margin="0,0,0,5">
                    <CheckBox x:Name="chkProfileBackup" Content="Create backup before copying" IsChecked="True"
                              VerticalAlignment="Center" Margin="0,0,0,5"/>
                    <WrapPanel>
                        <TextBlock Text="Quick Select:" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="11" Foreground="#666666"/>
                        <Button x:Name="btnProfileSelectPriceLabor" Content="Price &amp; Labor" MinWidth="100" Height="24"
                                Click="btnProfileSelectPriceLabor_Click" Margin="0,0,5,0"/>
                        <Button x:Name="btnProfileSelectAll" Content="Select All" MinWidth="80" Height="24"
                                Click="btnProfileSelectAll_Click" Margin="0,0,5,0"/>
                        <Button x:Name="btnProfileSelectNone" Content="Select None" MinWidth="90" Height="24"
                                Click="btnProfileSelectNone_Click"/>
                    </WrapPanel>
                </StackPanel>

                <!-- Data Types Checklist -->
                <GroupBox Grid.Row="3" Header="Data Types to Copy" Margin="0,0,0,8" Padding="4">
                    <ListView x:Name="lstProfileDataTypes" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListView.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.HeaderTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="0,6,0,2">
                                            <CheckBox Tag="{Binding Name}"
                                                      Click="ProfileGroupCheckBox_Click"
                                                      IsThreeState="True"
                                                      VerticalAlignment="Center" Margin="0,0,6,0"/>
                                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="12"
                                                       Foreground="#0696D7"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </GroupStyle.HeaderTemplate>
                            </GroupStyle>
                        </ListView.GroupStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="2">
                                    <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                              IsEnabled="{Binding IsAvailable}"
                                              VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <TextBlock Text="{Binding DisplayName}" VerticalAlignment="Center" FontSize="12"
                                               MouseLeftButtonUp="ProfileDataType_Click">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsAvailable}" Value="False">
                                                        <Setter Property="Foreground" Value="#AAAAAA"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding IsEnumerable}" Value="True">
                                                        <Setter Property="Cursor" Value="Hand"/>
                                                        <Setter Property="TextDecorations" Value="Underline"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock Text="{Binding SelectionIndicator}" FontSize="10" Foreground="#0696D7"
                                               VerticalAlignment="Center" Margin="5,0,0,0" FontWeight="SemiBold"/>
                                    <TextBlock Text=" (not in source)" FontSize="10" Foreground="#CCCCCC"
                                               VerticalAlignment="Center" Margin="5,0,0,0">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsAvailable}" Value="False">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </StackPanel>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </GroupBox>

                <!-- Progress + Status -->
                <StackPanel Grid.Row="4" Margin="0,0,0,5">
                    <StackPanel x:Name="pnlProfileProgress" Visibility="Collapsed">
                        <ProgressBar x:Name="prgProfileCopy" Height="18" Minimum="0" Maximum="100" Value="0"/>
                        <TextBlock x:Name="txtProfileCopyStatus" FontSize="11" Foreground="#666666" Margin="0,3,0,0" TextWrapping="Wrap"/>
                    </StackPanel>
                    <TextBlock x:Name="txtProfileStatus" FontSize="11" Foreground="#666666" Margin="0,3,0,0"/>
                </StackPanel>

                <!-- Action Buttons -->
                <DockPanel Grid.Row="5" Margin="0,0,0,5">
                    <Button x:Name="btnProfileCopy" Content="Copy Selected Data" Width="150" Height="28"
                            Click="btnProfileCopy_Click" DockPanel.Dock="Right" HorizontalAlignment="Right"/>
                    <TextBlock Text="AutoCAD must be restarted after copying." FontSize="11" Foreground="#E65100"
                               VerticalAlignment="Center" TextWrapping="Wrap"/>
                </DockPanel>

                <!-- Push to Profiles (Global only) -->
                <GroupBox x:Name="grpPushToProfiles" Grid.Row="6" Header="Push to Profiles (Global Only)"
                          Margin="0,8,0,0" Padding="6" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Push the selected data types above to multiple profiles at once."
                                   FontSize="11" Foreground="#666666" TextWrapping="Wrap" Margin="0,0,0,6"/>

                        <!-- Target profile checkboxes -->
                        <DockPanel Margin="0,0,0,4">
                            <TextBlock Text="Target Profiles:" VerticalAlignment="Center"
                                       FontWeight="SemiBold" FontSize="12" DockPanel.Dock="Left"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                                <Button x:Name="btnPushSelectAll" Content="All" Width="50" Height="22"
                                        Click="btnPushSelectAll_Click" Margin="0,0,5,0"/>
                                <Button x:Name="btnPushSelectNone" Content="None" Width="50" Height="22"
                                        Click="btnPushSelectNone_Click"/>
                            </StackPanel>
                        </DockPanel>

                        <Border BorderBrush="#D0D0D0" BorderThickness="1" CornerRadius="3"
                                MaxHeight="140" Margin="0,0,0,6">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel x:Name="pnlPushTargetProfiles" Margin="4"/>
                            </ScrollViewer>
                        </Border>

                        <!-- Push progress -->
                        <StackPanel x:Name="pnlPushProgress" Visibility="Collapsed" Margin="0,0,0,4">
                            <ProgressBar x:Name="prgPushProgress" Height="18" Minimum="0" Maximum="100"/>
                            <TextBlock x:Name="txtPushStatus" FontSize="11" Foreground="#666666"
                                       Margin="0,3,0,0" TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- Push button -->
                        <DockPanel>
                            <Button x:Name="btnPushToProfiles" Content="Push Selected Data"
                                    Width="150" Height="28" Click="btnPushToProfiles_Click"
                                    DockPanel.Dock="Right" HorizontalAlignment="Right"/>
                            <TextBlock x:Name="txtPushResultStatus" FontSize="11" Foreground="#666666"
                                       VerticalAlignment="Center" TextWrapping="Wrap"/>
                        </DockPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Restore Backup -->
                <GroupBox Grid.Row="7" Header="Restore Backup" Margin="0,5,0,0" Padding="6">
                    <DockPanel>
                        <Button x:Name="btnProfileRestore" Content="Restore" Width="80" Height="26"
                                Click="btnProfileRestore_Click" DockPanel.Dock="Right" Margin="8,0,0,0"
                                VerticalAlignment="Top"/>
                        <Button x:Name="btnProfileOpenBackups" Content="Open Folder" Width="90" Height="26"
                                Click="btnProfileOpenBackups_Click" DockPanel.Dock="Right" Margin="8,0,0,0"
                                VerticalAlignment="Top"/>
                        <StackPanel>
                            <ComboBox x:Name="cmbProfileBackups" Height="26"
                                      SelectionChanged="cmbProfileBackups_SelectionChanged"
                                      DisplayMemberPath="" IsEditable="False"/>
                            <TextBlock x:Name="txtProfileBackupInfo" FontSize="11" Foreground="#888888"
                                       TextWrapping="Wrap" Margin="0,4,0,0"/>
                        </StackPanel>
                    </DockPanel>
                </GroupBox>
            </Grid>
        </TabItem>
    </TabControl>
</UserControl>
