<Window x:Class="FabricationSample.ProfileCopy.Windows.ProfileDataCopyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Profile Data Copy" Height="600" Width="550" MinHeight="450" MinWidth="420"
        WindowStartupLocation="CenterScreen" ResizeMode="CanResizeWithGrip"
        Loaded="Window_Loaded">

    <Window.Resources>
        <ResourceDictionary>
            <!-- Inline styles matching the shared palette for standalone DLL use -->
            <SolidColorBrush x:Key="PrimaryBrush" Color="#0696D7"/>
            <SolidColorBrush x:Key="PrimaryDarkBrush" Color="#0578AB"/>
            <SolidColorBrush x:Key="DarkBrush" Color="#3d3d3d"/>
            <SolidColorBrush x:Key="TextBrush" Color="#333333"/>
            <SolidColorBrush x:Key="BorderBrush" Color="#D0D0D0"/>
            <SolidColorBrush x:Key="LightBrush" Color="#F5F5F5"/>

            <Style x:Key="PrimaryButton" TargetType="Button">
                <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Height" Value="30"/>
                <Setter Property="Padding" Value="12,4"/>
                <Setter Property="FontSize" Value="13"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}"
                                    CornerRadius="3" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="True">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="{StaticResource PrimaryDarkBrush}"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#046B96"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="#B0B0B0"/>
                                    <Setter Property="Foreground" Value="#E0E0E0"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="SecondaryButton" TargetType="Button">
                <Setter Property="Background" Value="White"/>
                <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Height" Value="30"/>
                <Setter Property="Padding" Value="12,4"/>
                <Setter Property="FontSize" Value="13"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="3" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="True">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#E8E8E8"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#D8D8D8"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="#F0F0F0"/>
                                    <Setter Property="Foreground" Value="#B0B0B0"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource DarkBrush}" CornerRadius="3" Padding="12,8" Margin="0,0,0,12">
            <StackPanel>
                <TextBlock Text="Copy Profile Data" FontSize="18" FontWeight="SemiBold" Foreground="White"/>
                <TextBlock Text="Copy database configuration files (.map) from another profile to the current one."
                           FontSize="11" Foreground="#CCCCCC" Margin="0,3,0,0" TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <!-- Current Profile Info -->
        <TextBlock Grid.Row="0" x:Name="txtCurrentProfile" FontSize="10" Foreground="#888888"
                   Margin="0,0,0,0" VerticalAlignment="Bottom" HorizontalAlignment="Right"/>

        <!-- Source Profile Selection -->
        <GroupBox Grid.Row="1" Header="Source Profile" Margin="0,0,0,8" Padding="8">
            <StackPanel>
                <ComboBox x:Name="cmbSourceProfile" Height="28" Margin="0,0,0,5"
                          SelectionChanged="cmbSourceProfile_SelectionChanged"
                          DisplayMemberPath="" IsEditable="False">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                    <ComboBox.ItemContainerStyle>
                        <Style TargetType="ComboBoxItem">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsCurrent}" Value="True">
                                    <Setter Property="Foreground" Value="#999999"/>
                                    <Setter Property="FontStyle" Value="Italic"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ComboBox.ItemContainerStyle>
                </ComboBox>
                <TextBlock x:Name="txtProfilePath" FontSize="11" Foreground="#888888" TextWrapping="Wrap"/>
            </StackPanel>
        </GroupBox>

        <!-- Options -->
        <StackPanel Grid.Row="2" Margin="0,0,0,5">
            <CheckBox x:Name="chkBackup" Content="Create backup before copying" IsChecked="True"
                      VerticalAlignment="Center" Margin="0,0,0,5"/>
            <WrapPanel>
                <TextBlock Text="Quick Select:" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="11" Foreground="#666666"/>
                <Button x:Name="btnSelectPriceLabor" Content="Price &amp; Labor" MinWidth="100" Height="24"
                        Style="{StaticResource SecondaryButton}" Click="btnSelectPriceLabor_Click"/>
                <Button x:Name="btnSelectAll" Content="Select All" MinWidth="80" Height="24"
                        Style="{StaticResource SecondaryButton}" Click="btnSelectAll_Click" Margin="5,0,0,0"/>
                <Button x:Name="btnSelectNone" Content="Select None" MinWidth="90" Height="24"
                        Style="{StaticResource SecondaryButton}" Click="btnSelectNone_Click" Margin="5,0,0,0"/>
            </WrapPanel>
        </StackPanel>

        <!-- Data Types Checklist -->
        <GroupBox Grid.Row="3" Header="Data Types to Copy" Margin="0,0,0,8" Padding="4">
            <ListView x:Name="lstDataTypes" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                <ListView.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.HeaderTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,6,0,2">
                                    <CheckBox Tag="{Binding Name}"
                                              Click="GroupCheckBox_Click"
                                              IsThreeState="True"
                                              VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="12"
                                               Foreground="{StaticResource PrimaryBrush}"/>
                                </StackPanel>
                            </DataTemplate>
                        </GroupStyle.HeaderTemplate>
                    </GroupStyle>
                </ListView.GroupStyle>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Margin="2">
                            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                      IsEnabled="{Binding IsAvailable}"
                                      VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="{Binding DisplayName}" VerticalAlignment="Center" FontSize="12"
                                       MouseLeftButtonUp="DataType_Click">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsAvailable}" Value="False">
                                                <Setter Property="Foreground" Value="#AAAAAA"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding IsEnumerable}" Value="True">
                                                <Setter Property="Cursor" Value="Hand"/>
                                                <Setter Property="TextDecorations" Value="Underline"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <TextBlock Text="{Binding SelectionIndicator}" FontSize="10" Foreground="{StaticResource PrimaryBrush}"
                                       VerticalAlignment="Center" Margin="5,0,0,0" FontWeight="SemiBold"/>
                            <TextBlock Text=" (not found in source)" FontSize="10" Foreground="#CCCCCC"
                                       VerticalAlignment="Center" Margin="5,0,0,0">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsAvailable}" Value="False">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </GroupBox>

        <!-- Progress -->
        <StackPanel Grid.Row="4" x:Name="pnlProgress" Visibility="Collapsed" Margin="0,0,0,8">
            <ProgressBar x:Name="prgCopy" Height="20" Minimum="0" Maximum="100" Value="0"/>
            <TextBlock x:Name="txtStatus" FontSize="11" Foreground="#666666" Margin="0,4,0,0" TextWrapping="Wrap"/>
        </StackPanel>

        <!-- Warning notice -->
        <Border Grid.Row="5" Background="#FFF3E0" BorderBrush="#FFE0B2" BorderThickness="1"
                CornerRadius="3" Padding="8" Margin="0,0,0,10">
            <TextBlock FontSize="11" Foreground="#E65100" TextWrapping="Wrap">
                <Run FontWeight="SemiBold">Note:</Run>
                <Run>Copying .map files will overwrite the corresponding data in your current profile. AutoCAD must be restarted for changes to take effect.</Run>
            </TextBlock>
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="btnCopy" Content="Copy Selected Data" Width="150"
                    Style="{StaticResource PrimaryButton}" Click="btnCopy_Click"/>
            <Button x:Name="btnCancel" Content="Cancel" Width="80" Margin="10,0,0,0"
                    Style="{StaticResource SecondaryButton}" Click="btnCancel_Click"/>
        </StackPanel>
    </Grid>
</Window>
